import{y as x,X as F,Y as C,Z as v,f as y,E,G as M}from"./C8_MLYNb.js";function q(t,e){const r=e/t*100;return 2/Math.PI*100*Math.atan(r/50)}function H(t={}){const{duration:e=2e3,throttle:r=200,hideDelay:u=500,resetDelay:d=400}=t,c=t.estimatedProgress||q,l=x(),a=v(0),n=v(!1),m=v(!1);let h=!1,p,_,D,I;const T=(o={})=>{P(),m.value=!1,b(0,o)};function b(o=0,i={}){if(l.isHydrating)return;if(o>=100)return f({force:i.force});g(),a.value=o<0?0:o;const s=i.force?0:r;s?_=setTimeout(()=>{n.value=!0,L()},s):(n.value=!0,L())}function N(){D=setTimeout(()=>{n.value=!1,I=setTimeout(()=>{a.value=0},d)},u)}function f(o={}){a.value=100,h=!0,g(),P(),o.error&&(m.value=!0),o.force?(a.value=0,n.value=!1):N()}function P(){clearTimeout(D),clearTimeout(I)}function g(){clearTimeout(_),cancelAnimationFrame(p)}function L(){h=!1;let o;function i(s){if(h)return;o??(o=s);const S=s-o;a.value=Math.max(0,Math.min(100,c(e,S))),p=requestAnimationFrame(i)}p=requestAnimationFrame(i)}let k=()=>{};{const o=l.hook("page:loading:start",()=>{T()}),i=l.hook("page:loading:end",()=>{f()}),s=l.hook("vue:error",()=>f());k=()=>{s(),o(),i(),g()}}return{_cleanup:k,progress:y(()=>a.value),isLoading:y(()=>n.value),error:y(()=>m.value),start:T,set:b,finish:f,clear:g}}function $(t={}){const e=x(),r=e._loadingIndicator||(e._loadingIndicator=H(t));return F()&&(e._loadingIndicatorDeps||(e._loadingIndicatorDeps=0),e._loadingIndicatorDeps++,C(()=>{e._loadingIndicatorDeps--,e._loadingIndicatorDeps===0&&(r._cleanup(),delete e._loadingIndicator)})),r}const z=E({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},hideDelay:{type:Number,default:500},resetDelay:{type:Number,default:400},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},errorColor:{type:String,default:"repeating-linear-gradient(to right,#f87171 0%,#ef4444 100%)"},estimatedProgress:{type:Function,required:!1}},setup(t,{slots:e,expose:r}){const{progress:u,isLoading:d,error:c,start:l,finish:a,clear:n}=$({duration:t.duration,throttle:t.throttle,hideDelay:t.hideDelay,resetDelay:t.resetDelay,estimatedProgress:t.estimatedProgress});return r({progress:u,isLoading:d,error:c,start:l,finish:a,clear:n}),()=>M("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${t.height}px`,opacity:d.value?1:0,background:c.value?t.errorColor:t.color||void 0,backgroundSize:`${100/u.value*100}% auto`,transform:`scaleX(${u.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},e)}});export{z as _};
