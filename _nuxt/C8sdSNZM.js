import{L as at}from"./DpGbaO0b.js";import{_ as nt,s as it,r as J,z as ot,D as A,f as h,c as n,C as rt,p as f,F as k,a as s,g as y,n as C,t as c,h as D,A as j,b as ct,e as U,j as O,H as dt,k as ut,o as a,l as pt,P as vt}from"./BbWWPUek.js";import{F as ft}from"./DkfbrLYj.js";const bt={class:"tabs-container print-hide"},gt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},yt=["aria-selected"],mt={class:"badge"},_t=["aria-selected"],ht={class:"badge"},kt=["aria-selected"],Ct={class:"tab-content"},Dt={id:"tab-content-lista",role:"tabpanel",class:"text-center"},jt={key:0},At={key:1},Ot={key:2},$t={key:3},St={id:"tab-content-filters",role:"tabpanel"},Tt={id:"tab-content-print",role:"tabpanel"},xt={style:{"margin-top":"10px"},class:"a4"},Ft={class:"settings-list"},Lt=["onDragstart","onDragover","onDrop"],wt=["onClick"],Bt=["onClick"],Vt={key:0,class:"print-page"},zt={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},Mt={key:0,class:"nowrap"},Nt={key:0},Rt=["innerHTML"],Gt={__name:"calendar",setup(It){const{lista:i}=it(),$=dt(),K=ut(),d=J("lista"),Q=J(null),o=ot({}),S=e=>e==null?void 0:e.replace(/-$/,"").trim(),X=e=>{const l=new Date(e).toLocaleString("pt-BR",{month:"long"});return l.charAt(0).toUpperCase()+l.slice(1)},Y=()=>{const e=$.query;if(Object.assign(i.filters,{...["search","title","locale","date","start","end"].reduce((t,l)=>(e[l]&&(t[l]=e[l]),t),{}),calendars:e.calendars?Array.isArray(e.calendars)?e.calendars:e.calendars.split(","):[]}),e.visible&&Object.keys(o).length){const t=Array.isArray(e.visible)?e.visible:e.visible.split(",");for(const l of Object.keys(o))o[l]=t.includes(l)}},Z=()=>{const e=Object.entries(o).filter(([l,u])=>u).map(([l])=>l),t={...$.query};e.length?t.visible=e.join(","):delete t.visible,K.replace({query:t})};A(()=>JSON.stringify(o),()=>Z());const tt=h(()=>{const e=i.filters;return e?["search","title","locale","date","calendars"].filter(t=>e[t]&&(Array.isArray(e[t])?e[t].length:!0)).length:0}),et=h(()=>Object.values(o).filter(Boolean).length),st=()=>{d.value="lista",setTimeout(()=>{window.print(),d.value="print"},500)},T=h(()=>{const e={},t=i.eventsFiltered.filter(l=>!["AVISOS À IRMANDADE"].includes(l.title));for(const l of t||[]){const[u,b]=(l.date||"").split("-");if(!u||!b)continue;const v=`${u}-${b}-01 12:00:00`;(e[v]||(e[v]=[])).push(l)}return Object.entries(e).map(([l,u])=>({month:l,items:u.sort((b,v)=>{var g,_;return((g=b.date)==null?void 0:g.localeCompare(v.date))||((_=b.title)==null?void 0:_.localeCompare(v.title))})})).sort((l,u)=>l.month.localeCompare(u.month))}),x=e=>o[e]=!o[e],lt=h(()=>Object.values(o).every(Boolean)),F=e=>Object.keys(o).forEach(t=>o[t]=e),L=h(()=>{const e=new Map;for(const t of i.eventsFiltered||[]){const l=t.title||"Sem título";e.has(l)||e.set(l,[]),e.get(l).push(t)}return[...e.entries()].map(([t,l])=>({title:t,items:l.sort((u,b)=>{var v,g;return((v=u.date)==null?void 0:v.localeCompare(b.date))||((g=u.title)==null?void 0:g.localeCompare(b.title))})}))});return A(()=>i.eventsFiltered,()=>{for(const e of i.eventsFiltered||[]){const t=e.title||"Sem título";t in o||(o[t]=!0)}Y()},{immediate:!0}),A(L,e=>{e.forEach(({title:t})=>{t in o||(o[t]=!0)})},{immediate:!0}),(e,t)=>{var u,b,v,g,_,w,B,V,z,M,N,R,G,I,E,q,H,W,P;const l=at;return a(),n("div",null,[f(i).loading?(a(),rt(l,{key:0})):(a(),n(k,{key:1},[s("div",bt,[s("nav",gt,[s("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:C(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=p=>d.value="filters")},[s("span",mt,c(tt.value),1),t[5]||(t[5]=s("i",{class:"la la-filter z-10"},null,-1))],10,yt),s("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:C(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=p=>d.value="print")},[s("span",ht,c(et.value),1),t[6]||(t[6]=s("i",{class:"la la-print"},null,-1))],10,_t),s("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:C(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=p=>d.value="lista")}," Calendário ",10,kt)])]),s("div",Ct,[D(s("div",Dt,[t[7]||(t[7]=s("div",null,"CALENDÁRIO",-1)),(b=(u=f(i).filters)==null?void 0:u.calendars)!=null&&b.length?(a(),n("div",jt,[s("b",null,c(f(i).filters.calendars.map(S).join(", ")),1)])):y("",!0),(v=f(i).filters)!=null&&v.locale?(a(),n("div",At,[s("b",null,c(S((g=f(i).filters)==null?void 0:g.locale)),1)])):y("",!0),(_=f(i).filters)!=null&&_.date?(a(),n("div",Ot," Data: "+c((z=(V=(B=(w=f(i).filters.date)==null?void 0:w.split("T")[0])==null?void 0:B.split("-"))==null?void 0:V.reverse())==null?void 0:z.join("/")),1)):y("",!0),s("div",null,c((I=(G=(R=(N=(M=f(i).filters)==null?void 0:M.start)==null?void 0:N.split("T")[0])==null?void 0:R.split("-"))==null?void 0:G.reverse())==null?void 0:I.join("/"))+" à "+c((P=(W=(H=(q=(E=f(i).filters)==null?void 0:E.end)==null?void 0:q.split("T")[0])==null?void 0:H.split("-"))==null?void 0:W.reverse())==null?void 0:P.join("/")),1),f(i).filters.search?(a(),n("div",$t,c(f(i).filters.search),1)):y("",!0)],512),[[j,d.value==="lista"]]),D(s("div",St,[ct(ft)],512),[[j,d.value==="filters"]]),D(s("div",Tt,[s("div",{class:"text-center"},[t[9]||(t[9]=s("p",{class:"mb-4"},"Ajustes de impressão:",-1)),s("button",{class:"success",onClick:st},t[8]||(t[8]=[s("i",{class:"la la-print"},null,-1),U(" Imprimir ")]))]),s("div",xt,[s("div",Ft,[t[10]||(t[10]=s("b",null,"Lista",-1)),s("div",null,[lt.value?(a(),n("i",{key:0,class:"la la-toggle-on",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#22c55e"},title:"Ocultar todos",onClick:t[3]||(t[3]=p=>F(!1))})):(a(),n("i",{key:1,class:"la la-toggle-off",title:"Mostrar todos",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#dc2626"},onClick:t[4]||(t[4]=p=>F(!0))}))])]),(a(!0),n(k,null,O(L.value,(p,m)=>(a(),n("div",{key:p.title,class:C(["settings-list",{"drag-over":Q.value===m}]),draggable:"true",onDragstart:r=>e.onDragStart(m),onDragover:pt(r=>e.onDragOver(m),["prevent"]),onDrop:r=>e.onDrop(m)},[U(c(p.title)+" ",1),o[p.title]?(a(),n("i",{key:1,class:"la la-toggle-on",style:{cursor:"pointer","font-size":"14px",padding:"8px",color:"#22c55e"},onClick:r=>x(p.title)},null,8,Bt)):(a(),n("i",{key:0,class:"la la-toggle-off",onClick:r=>x(p.title)},null,8,wt))],42,Lt))),128))])],512),[[j,d.value==="print"]])]),T.value.length?(a(),n("div",Vt,[(a(!0),n(k,null,O(T.value,({month:p,items:m})=>(a(),n("div",{key:p,class:"month-section"},[s("table",null,[s("thead",null,[s("tr",null,[s("th",zt,c(X(p)),1)])]),s("tbody",null,[(a(!0),n(k,null,O(m,r=>D((a(),n("tr",{key:r.id},[s("td",null,[r.formatDate?(a(),n("span",Mt,c(r.formatDate.split("/")[0])+" | "+c(r.formatWeek),1)):y("",!0)]),s("td",null,[r.formatTime?(a(),n("span",Nt,c(r.formatTime),1)):y("",!0)]),s("td",null,c(r.locale),1),s("td",null,c(r.title),1),s("td",null,[r.desc?(a(),n("span",{key:0,innerHTML:f(vt)(r.desc)},null,8,Rt)):y("",!0)])])),[[j,o[r.title||"Sem título"]]])),128))])])]))),128))])):y("",!0)],64))])}}},Wt=nt(Gt,[["__scopeId","data-v-8708d042"]]);export{Wt as default};
