import{L as it}from"./CJkCATWL.js";import{_ as rt,s as ct,r as K,B as dt,D as S,f as k,c,I as C,p as a,F as D,a as s,g as _,n as j,b as A,t as d,h as O,G as $,e as X,j as x,C as ut,k as pt,o as n,l as vt,Q as ft}from"./WFx7aDd1.js";import{F as bt}from"./CLycYwld.js";import g from"./D9ulxedu.js";const mt={class:"tabs-container print-hide"},_t={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},gt=["aria-selected"],yt={class:"badge"},ht=["aria-selected"],kt={class:"badge"},Ct=["aria-selected"],Dt={class:"tab-content"},jt={id:"tab-content-lista",role:"tabpanel",class:"text-center"},At={key:0},Ot={key:1},$t={key:2},St={key:3},xt={id:"tab-content-filters",role:"tabpanel"},Tt={id:"tab-content-print",role:"tabpanel"},Bt={class:"text-center"},Ft={style:{"margin-top":"10px"},class:"a4"},Lt={class:"settings-list"},wt=["onDragstart","onDragover","onDrop"],Vt={key:0,class:"print-page"},Mt={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},zt={key:0,class:"nowrap"},Gt={key:0},It=["innerHTML"],Nt={__name:"calendar",setup(Rt){const{lista:o}=ct(),T=ut(),Y=pt(),u=K("lista"),Z=K(null),i=dt({}),B=t=>t==null?void 0:t.replace(/-$/,"").trim(),tt=t=>{const l=new Date(t).toLocaleString("pt-BR",{month:"long"});return l.charAt(0).toUpperCase()+l.slice(1)},et=()=>{const t=T.query;if(Object.assign(o.filters,{...["search","title","locale","date","start","end"].reduce((e,l)=>(t[l]&&(e[l]=t[l]),e),{}),calendars:t.calendars?Array.isArray(t.calendars)?t.calendars:t.calendars.split(","):[]}),t.visible&&Object.keys(i).length){const e=Array.isArray(t.visible)?t.visible:t.visible.split(",");for(const l of Object.keys(i))i[l]=e.includes(l)}},st=()=>{const t=Object.entries(i).filter(([l,p])=>p).map(([l])=>l),e={...T.query};t.length?e.visible=t.join(","):delete e.visible,Y.replace({query:e})};S(()=>JSON.stringify(i),()=>st());const lt=k(()=>{const t=o.filters;return t?["search","title","locale","date","calendars"].filter(e=>t[e]&&(Array.isArray(t[e])?t[e].length:!0)).length:0}),nt=k(()=>Object.values(i).filter(Boolean).length),at=()=>{u.value="lista",setTimeout(()=>{window.print(),u.value="print"},500)},F=k(()=>{const t={},e=o.eventsFiltered.filter(l=>!["AVISOS À IRMANDADE"].includes(l.title));for(const l of e||[]){const[p,b]=(l.date||"").split("-");if(!p||!b)continue;const f=`${p}-${b}-01 12:00:00`;(t[f]||(t[f]=[])).push(l)}return Object.entries(t).map(([l,p])=>({month:l,items:p.sort((b,f)=>{var m,h;return((m=b.date)==null?void 0:m.localeCompare(f.date))||((h=b.title)==null?void 0:h.localeCompare(f.title))})})).sort((l,p)=>l.month.localeCompare(p.month))}),L=t=>i[t]=!i[t],ot=k(()=>Object.values(i).every(Boolean)),w=t=>Object.keys(i).forEach(e=>i[e]=t),V=k(()=>{const t=new Map;for(const e of o.eventsFiltered||[]){const l=e.title||"Sem título";t.has(l)||t.set(l,[]),t.get(l).push(e)}return[...t.entries()].map(([e,l])=>({title:e,items:l.sort((p,b)=>{var f,m;return((f=p.date)==null?void 0:f.localeCompare(b.date))||((m=p.title)==null?void 0:m.localeCompare(b.title))})}))});return S(()=>o.eventsFiltered,()=>{for(const t of o.eventsFiltered||[]){const e=t.title||"Sem título";e in i||(i[e]=!0)}et()},{immediate:!0}),S(V,t=>{t.forEach(({title:e})=>{e in i||(i[e]=!0)})},{immediate:!0}),(t,e)=>{var p,b,f,m,h,M,z,G,I,N,R,E,q,W,H,J,P,Q,U;const l=it;return n(),c("div",null,[a(o).loading?(n(),C(l,{key:0})):(n(),c(D,{key:1},[s("div",mt,[s("nav",_t,[s("span",{id:"tab-filters","aria-selected":u.value==="filters",role:"tab",type:"button",class:j(["tab",{active:u.value==="filters"}]),style:{position:"relative"},onClick:e[0]||(e[0]=v=>u.value="filters")},[s("span",yt,d(lt.value),1),A(a(g),{name:"la:filter",class:"icon z-10"})],10,gt),s("span",{id:"tab-print","aria-selected":u.value==="print",role:"tab",type:"button",class:j(["tab",{active:u.value==="print"}]),onClick:e[1]||(e[1]=v=>u.value="print")},[s("span",kt,d(nt.value),1),A(a(g),{name:"la:print",class:"icon"})],10,ht),s("span",{id:"tab-lista","aria-selected":u.value==="lista",role:"tab",type:"button",class:j(["tab",{active:u.value==="lista"}]),onClick:e[2]||(e[2]=v=>u.value="lista")}," Calendário ",10,Ct)])]),s("div",Dt,[O(s("div",jt,[e[5]||(e[5]=s("div",null,"CALENDÁRIO",-1)),(b=(p=a(o).filters)==null?void 0:p.calendars)!=null&&b.length?(n(),c("div",At,[s("b",null,d(a(o).filters.calendars.map(B).join(", ")),1)])):_("",!0),(f=a(o).filters)!=null&&f.locale?(n(),c("div",Ot,[s("b",null,d(B((m=a(o).filters)==null?void 0:m.locale)),1)])):_("",!0),(h=a(o).filters)!=null&&h.date?(n(),c("div",$t," Data: "+d((I=(G=(z=(M=a(o).filters.date)==null?void 0:M.split("T")[0])==null?void 0:z.split("-"))==null?void 0:G.reverse())==null?void 0:I.join("/")),1)):_("",!0),s("div",null,d((W=(q=(E=(R=(N=a(o).filters)==null?void 0:N.start)==null?void 0:R.split("T")[0])==null?void 0:E.split("-"))==null?void 0:q.reverse())==null?void 0:W.join("/"))+" à "+d((U=(Q=(P=(J=(H=a(o).filters)==null?void 0:H.end)==null?void 0:J.split("T")[0])==null?void 0:P.split("-"))==null?void 0:Q.reverse())==null?void 0:U.join("/")),1),a(o).filters.search?(n(),c("div",St,d(a(o).filters.search),1)):_("",!0)],512),[[$,u.value==="lista"]]),O(s("div",xt,[A(bt)],512),[[$,u.value==="filters"]]),O(s("div",Tt,[s("div",Bt,[e[7]||(e[7]=s("p",{class:"mb-4"},"Ajustes de impressão:",-1)),s("button",{class:"success",onClick:at},[A(a(g),{name:"la:print",class:"icon"}),e[6]||(e[6]=X(" Imprimir "))])]),s("div",Ft,[s("div",Lt,[e[8]||(e[8]=s("b",null,"Lista",-1)),s("div",null,[ot.value?(n(),C(a(g),{key:0,name:"la:toggle-on",class:"icon",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#22c55e"},title:"Ocultar todos",onClick:e[3]||(e[3]=v=>w(!1))})):(n(),C(a(g),{key:1,name:"la:toggle-off",title:"Mostrar todos",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#dc2626"},class:"icon",onClick:e[4]||(e[4]=v=>w(!0))}))])]),(n(!0),c(D,null,x(V.value,(v,y)=>(n(),c("div",{key:v.title,class:j(["settings-list",{"drag-over":Z.value===y}]),draggable:"true",onDragstart:r=>t.onDragStart(y),onDragover:vt(r=>t.onDragOver(y),["prevent"]),onDrop:r=>t.onDrop(y)},[X(d(v.title)+" ",1),i[v.title]?(n(),C(a(g),{key:1,name:"la:toggle-on",class:"icon",style:{cursor:"pointer","font-size":"14px",padding:"8px",color:"#22c55e"},onClick:r=>L(v.title)},null,8,["onClick"])):(n(),C(a(g),{key:0,name:"la:toggle-off",class:"icon",onClick:r=>L(v.title)},null,8,["onClick"]))],42,wt))),128))])],512),[[$,u.value==="print"]])]),F.value.length?(n(),c("div",Vt,[(n(!0),c(D,null,x(F.value,({month:v,items:y})=>(n(),c("div",{key:v,class:"month-section"},[s("table",null,[s("thead",null,[s("tr",null,[s("th",Mt,d(tt(v)),1)])]),s("tbody",null,[(n(!0),c(D,null,x(y,r=>O((n(),c("tr",{key:r.id},[s("td",null,[r.formatDate?(n(),c("span",zt,d(r.formatDate.split("/")[0])+" | "+d(r.formatWeek),1)):_("",!0)]),s("td",null,[r.formatTime?(n(),c("span",Gt,d(r.formatTime),1)):_("",!0)]),s("td",null,d(r.locale),1),s("td",null,d(r.title),1),s("td",null,[r.desc?(n(),c("span",{key:0,innerHTML:a(ft)(r.desc)},null,8,It)):_("",!0)])])),[[$,i[r.title||"Sem título"]]])),128))])])]))),128))])):_("",!0)],64))])}}},Jt=rt(Nt,[["__scopeId","data-v-10735470"]]);export{Jt as default};
